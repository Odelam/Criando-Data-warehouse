select non empty ({[Tempo].[Hierarquia do Mês e Ano].[Ano].&[2013].&[Primeiro Semestre 2013].&[2013]&[01-2013]&[01-2013].children}) on rows,
({[Measures].[Faturamento]}) on columns
from [COMPLETO]

with member [Measures].[% Taxa Variação] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].[Ano].&[2013].&[Primeiro Semestre 2013].&[2013]&[01-2013]&[01-2013])',
format_string = '#,###.## %'
select non empty ({[Tempo].[Hierarquia do Mês e Ano].[Ano].&[2013].&[Primeiro Semestre 2013].&[2013]&[01-2013]&[01-2013].children}) on rows,
({[Measures].[Faturamento], [Measures].[% Taxa Variação]}) on columns
from [COMPLETO]

with member [Measures].[% Taxa Variação] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].Currentmember.Parent)',
format_string = '#,###.## %'
select non empty ({[Tempo].[Hierarquia do Mês e Ano].[Ano].&[2013].&[Primeiro Semestre 2013].&[2013]&[01-2013]&[01-2013].children}) on rows,
({[Measures].[Faturamento], [Measures].[% Taxa Variação]}) on columns
from [COMPLETO]

with member [Measures].[% Taxa Variação] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].Currentmember.Parent)',
format_string = '#,###.## %'
select non empty ({[Tempo].[Hierarquia do Mês e Ano].[Ano].&[2013].&[Primeiro Semestre 2013].children}) on rows,
({[Measures].[Faturamento], [Measures].[% Taxa Variação]}) on columns
from [COMPLETO]

with member [Measures].[% Taxa Variação Trimestre] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].Currentmember.Parent)',
format_string = '#,###.## %'
select non empty ({[Tempo].[Hierarquia do Mês e Ano].[Nível Mës e Ano].members}) on rows,
({[Measures].[Faturamento], [Measures].[% Taxa Variação Trimestre]}) on columns
from [COMPLETO]


with member [Measures].[% Taxa Variação Trimestre] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].Currentmember.Parent)',
format_string = '#,###.## %'
member [Measures].[% Taxa Variação Semestre] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].Currentmember.Parent.Parent)',
format_string = '#,###.## %'
select non empty ({[Tempo].[Hierarquia do Mês e Ano].[Nível Mës e Ano].members}) on rows,
({[Measures].[Faturamento], [Measures].[% Taxa Variação Trimestre], [Measures].[% Taxa Variação Semestre]}) on columns
from [COMPLETO]

with member [Measures].[% Taxa Variação Trimestre] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].Currentmember.Parent)',
format_string = '#,###.## %'
member [Measures].[% Taxa Variação Semestre] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].Currentmember.Parent.Parent)',
format_string = '#,###.## %'
member [Measures].[% Taxa Variação Ano] as
'[Measures].[Faturamento] / ([Measures].[Faturamento], [Tempo].[Hierarquia do Mês e Ano].Currentmember.Parent.Parent.Parent)',
format_string = '#,###.## %'
select non empty ({[Tempo].[Hierarquia do Mês e Ano].[Nível Mës e Ano].members}) on rows,
({[Measures].[Faturamento], [Measures].[% Taxa Variação Trimestre], [Measures].[% Taxa Variação Semestre], [Measures].[% Taxa Variação Ano]}) on columns
from [COMPLETO]

WITH MEMBER [Measures].[Participação de Vendas por Fábrica] AS
' [Measures].[Faturamento] / 
( [Measures].[Faturamento], [Fábrica].[Hierarquia das Fábricas].Currentmember.Parent )'
, FORMAT_STRING = '#,###.## %'
SELECT NON EMPTY 
({[Fábrica].[Hierarquia das Fábricas].[Nível Fábrica].Members}) on Rows,
({[Measures].[Faturamento], [Measures].[Participação de Vendas por Fábrica]}) on Columns from [COMPLETO]
WHERE [Tempo].[Hierarquia do Mês e Ano].[Ano].&[2014]

